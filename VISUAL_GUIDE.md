# ğŸ¯ SQL Data Analyst Agent - Visual Project Guide

## ğŸ—ï¸ Architecture Diagram (Text-Based)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INTERFACE                           â”‚
â”‚                      (Streamlit Web App)                        â”‚
â”‚                                                                 â”‚
â”‚  [Query Input] â†’ [Example Buttons] â†’ [Results Display]         â”‚
â”‚  [SQL View]    â†’ [Data Table]      â†’ [Charts]                  â”‚
â”‚  [Insights]    â†’ [Metrics Cards]   â†’ [Sidebar Info]            â”‚
â”‚                                                                 â”‚
â”‚                    ui/app.py, ui/components.py                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AGENT LAYER                              â”‚
â”‚                   (LangChain Orchestration)                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   SQL Agent  â”‚  â”‚  Agent Tools â”‚  â”‚ Error Handlerâ”‚         â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚         â”‚
â”‚  â”‚ - Processes  â”‚  â”‚ - search     â”‚  â”‚ - Repair SQL â”‚         â”‚
â”‚  â”‚   queries    â”‚  â”‚ - execute    â”‚  â”‚ - Retry loop â”‚         â”‚
â”‚  â”‚ - Generates  â”‚  â”‚ - get_info   â”‚  â”‚ - Max 3 triesâ”‚         â”‚
â”‚  â”‚   insights   â”‚  â”‚ - list_all   â”‚  â”‚              â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚        agent/sql_agent.py, agent/tools.py, agent/error_handler.pyâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â†“              â†“              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RAG LAYER      â”‚  â”‚  DATABASE LAYER  â”‚  â”‚   LLM PROVIDER   â”‚
â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Vector Store  â”‚ â”‚  â”‚ â”‚  DB Manager  â”‚ â”‚  â”‚ â”‚   OpenAI     â”‚ â”‚
â”‚ â”‚(Chroma)      â”‚ â”‚  â”‚ â”‚  (SQLite)    â”‚ â”‚  â”‚ â”‚   GPT-4      â”‚ â”‚
â”‚ â”‚              â”‚ â”‚  â”‚ â”‚              â”‚ â”‚  â”‚ â”‚              â”‚ â”‚
â”‚ â”‚- Schema docs â”‚ â”‚  â”‚ â”‚- customers   â”‚ â”‚  â”‚ â”‚- SQL gen     â”‚ â”‚
â”‚ â”‚- Embeddings  â”‚ â”‚  â”‚ â”‚- products    â”‚ â”‚  â”‚ â”‚- Insights    â”‚ â”‚
â”‚ â”‚- Search      â”‚ â”‚  â”‚ â”‚- orders      â”‚ â”‚  â”‚ â”‚- Repair      â”‚ â”‚
â”‚ â”‚              â”‚ â”‚  â”‚ â”‚- order_items â”‚ â”‚  â”‚ â”‚- Embeddings  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚ rag/             â”‚  â”‚ database/        â”‚  â”‚ OpenAI API       â”‚
â”‚ vector_store.py  â”‚  â”‚ db_manager.py    â”‚  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†‘              â†‘              â†‘
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  CONFIG LAYER     â”‚
                   â”‚                   â”‚
                   â”‚  - Settings       â”‚
                   â”‚  - API Keys       â”‚
                   â”‚  - Paths          â”‚
                   â”‚                   â”‚
                   â”‚  config/settings.pyâ”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Query Flow Diagram

```
START: User asks "Show me total sales by category"
  â”‚
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. UI Captures Input            â”‚
â”‚    ui/components.py             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Agent Receives Query         â”‚
â”‚    agent/sql_agent.py           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. RAG Search for Schema        â”‚
â”‚    rag/vector_store.py          â”‚
â”‚    â†’ Finds: products table      â”‚
â”‚             category column     â”‚
â”‚             order_items table   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. LLM Generates SQL            â”‚
â”‚    OpenAI GPT-4                 â”‚
â”‚    â†’ SELECT p.category,         â”‚
â”‚      SUM(oi.quantity * oi.price)â”‚
â”‚      FROM products p            â”‚
â”‚      JOIN order_items oi...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Execute SQL Query            â”‚
â”‚    database/db_manager.py       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
         â”‚ Error?  â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚
        Yes â”€â”€â”´â”€â”€ No
         â”‚         â”‚
         â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6a. Repair  â”‚  â”‚ 6b. Success!   â”‚
â”‚ error_      â”‚  â”‚ Returns data   â”‚
â”‚ handler.py  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â†’ Try again â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Visualize Results            â”‚
â”‚    ui/visualizer.py             â”‚
â”‚    â†’ Detects: category + number â”‚
â”‚    â†’ Creates: Bar chart         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Generate Insights            â”‚
â”‚    agent/sql_agent.py + GPT-4   â”‚
â”‚    â†’ "Electronics leads with... â”‚
â”‚       Furniture shows growth..."â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. Display to User              â”‚
â”‚    ui/components.py             â”‚
â”‚    Shows:                       â”‚
â”‚    âœ“ SQL Query                  â”‚
â”‚    âœ“ Data Table                 â”‚
â”‚    âœ“ Bar Chart                  â”‚
â”‚    âœ“ Insights                   â”‚
â”‚    âœ“ Metrics                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â†“
END: User sees complete analysis
```

## ğŸ“¦ Module Dependencies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ui/app.py  â”‚  (Entry Point)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ imports
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ui/components.py   ui/visualizer.py     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚
      â”‚ imports              â”‚ imports
      â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚agent/        â”‚        â”‚ plotly       â”‚
â”‚sql_agent.py  â”‚        â”‚ pandas       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ imports
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ agent/tools.py   agent/error_handler.py â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚
      â”‚ imports              â”‚ imports
      â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚rag/          â”‚        â”‚database/     â”‚
â”‚vector_store.pyâ”‚        â”‚db_manager.py â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚
       â”‚ imports              â”‚ imports
       â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚rag/          â”‚        â”‚database/     â”‚
â”‚schema_loader.pyâ”‚       â”‚db_setup.py   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ both import
                   â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚config/       â”‚
            â”‚settings.py   â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ imports
                   â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚python-dotenv â”‚
            â”‚pydantic      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—„ï¸ Database Schema Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     customers       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)             â”‚
â”‚ name                â”‚
â”‚ email (UNIQUE)      â”‚
â”‚ country             â”‚
â”‚ segment             â”‚
â”‚ created_at          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1:N
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      orders         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)             â”‚
â”‚ customer_id (FK) â”€â”€â”€â”˜
â”‚ order_date          â”‚
â”‚ status              â”‚
â”‚ total_amount        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1:N
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   order_items       â”‚  N:1 â”‚     products        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”€â”€â”€â”€â”€â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)             â”‚      â”‚ id (PK)             â”‚
â”‚ order_id (FK) â”€â”€â”€â”€â”€â”€â”˜      â”‚ name                â”‚
â”‚ product_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚ quantity            â”‚      â”‚ category            â”‚
â”‚ unit_price          â”‚      â”‚ price               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ created_at          â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Sample Counts:
- Customers: 10 records
- Products: 15 records
- Orders: 100 records
- Order Items: 200+ records
```

## ğŸ› ï¸ Tool Execution Flow

```
Agent decides to use tool
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Which tool needed? â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚    â”‚    â”‚    â”‚    â”‚
    â†“    â†“    â†“    â†“    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                       â”‚
â”‚  search_schema          execute_sql                   â”‚
â”‚  â”‚                      â”‚                             â”‚
â”‚  â”œâ†’ Vector search       â”œâ†’ Run SQL query              â”‚
â”‚  â”‚  over schema         â”‚  on database                â”‚
â”‚  â”‚                      â”‚                             â”‚
â”‚  â””â†’ Return context      â””â†’ Return results/error       â”‚
â”‚                                                       â”‚
â”‚  get_table_info         list_tables                   â”‚
â”‚  â”‚                      â”‚                             â”‚
â”‚  â”œâ†’ Get schema for      â”œâ†’ Get all table              â”‚
â”‚  â”‚  specific table      â”‚  names                      â”‚
â”‚  â”‚                      â”‚                             â”‚
â”‚  â””â†’ Return details      â””â†’ Return list                â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Results returned to agent
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent processes    â”‚
â”‚ and continues      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Flow Through Layers

```
Natural Language Query
         â†“
[UI Layer] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Capture & Display
         â†“
[Agent Layer] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Orchestrate Workflow
         â†“
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â†“         â†“
[RAG Layer]  [LLM] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Generate SQL
    â†“
[Database Layer] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Execute Query
    â†“
Results (DataFrame)
    â†“
    â”œâ”€â”€â†’ [Visualizer] â”€â”€â”€â”€â”€â”€â†’ Create Charts
    â”œâ”€â”€â†’ [Agent] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Generate Insights
    â””â”€â”€â†’ [UI] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Display Everything
```

## ğŸ¨ UI Component Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Streamlit App                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SIDEBAR   â”‚  â”‚      MAIN CONTENT            â”‚  â”‚
â”‚  â”‚            â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚ â„¹ï¸ About   â”‚  â”‚  ğŸ“Š SQL Data Analyst Agent  â”‚  â”‚
â”‚  â”‚            â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚ ğŸ’¡ Examplesâ”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  - Query 1 â”‚  â”‚  â”‚  Query Input Box       â”‚  â”‚  â”‚
â”‚  â”‚  - Query 2 â”‚  â”‚  â”‚  [ğŸ” Analyze Button]   â”‚  â”‚  â”‚
â”‚  â”‚  - Query 3 â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  - ...     â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚            â”‚  â”‚  âœ… Success Message          â”‚  â”‚
â”‚  â”‚ ğŸ“Š Schema  â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚  - Tables  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  - Columns â”‚  â”‚  â”‚ ğŸ” View SQL            â”‚  â”‚  â”‚
â”‚  â”‚            â”‚  â”‚  â”‚ SELECT ... FROM ...    â”‚  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚                  â”‚                              â”‚  â”‚
â”‚                  â”‚  ğŸ’¡ Insights                 â”‚  â”‚
â”‚                  â”‚  "Electronics leads with..." â”‚  â”‚
â”‚                  â”‚                              â”‚  â”‚
â”‚                  â”‚  ğŸ“ˆ Visualization            â”‚  â”‚
â”‚                  â”‚  [Interactive Plotly Chart]  â”‚  â”‚
â”‚                  â”‚                              â”‚  â”‚
â”‚                  â”‚  ğŸ“Š Key Metrics              â”‚  â”‚
â”‚                  â”‚  [Metric 1] [Metric 2] ...   â”‚  â”‚
â”‚                  â”‚                              â”‚  â”‚
â”‚                  â”‚  ğŸ“‹ Data Table               â”‚  â”‚
â”‚                  â”‚  [Scrollable DataFrame]      â”‚  â”‚
â”‚                  â”‚                              â”‚  â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Error Repair Loop

```
Execute SQL Query
      â”‚
      â†“
   Success?
      â”‚
  â”Œâ”€â”€â”€â”´â”€â”€â”€â”
  â”‚       â”‚
 YES     NO
  â”‚       â”‚
  â†“       â†“
Return  Extract Error
Results  Message
  â”‚       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”¤
          â†“
    Attempt < 3?
          â”‚
      â”Œâ”€â”€â”€â”´â”€â”€â”€â”
      â”‚       â”‚
     YES     NO
      â”‚       â”‚
      â†“       â†“
   LLM Repair  Return
   Query       Final Error
      â”‚
      â†“
   New SQL
      â”‚
      â””â”€â”€â†’ Execute SQL (Loop back)
```

## ğŸ“š File Dependency Graph

```
                    app.py (Main Entry)
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“               â†“               â†“
   components.py   sql_agent.py   visualizer.py
        â”‚               â”‚               â”‚
        â”‚          â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”          â”‚
        â”‚          â†“    â†“    â†“          â”‚
        â”‚       tools error  rag        â”‚
        â”‚          â”‚  handler â”‚         â”‚
        â”‚          â”‚    â”‚     â”‚         â”‚
        â”‚          â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜         â”‚
        â”‚               â”‚               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
                  db_manager.py
                        â”‚
                        â†“
                  db_setup.py
                        â”‚
                        â†“
                   settings.py
```

## ğŸ¯ Feature Checklist Visual

```
âœ… Natural Language Input â”€â”€â”€â†’ ui/components.py
âœ… SQL Generation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ agent/sql_agent.py
âœ… RAG Schema Search â”€â”€â”€â”€â”€â”€â”€â”€â†’ rag/vector_store.py
âœ… Query Execution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ database/db_manager.py
âœ… Error Repair (Ã—3) â”€â”€â”€â”€â”€â”€â”€â”€â†’ agent/error_handler.py
âœ… Time Series Charts â”€â”€â”€â”€â”€â”€â”€â†’ ui/visualizer.py
âœ… Bar Charts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/visualizer.py
âœ… Pie Charts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/visualizer.py
âœ… Scatter Plots â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/visualizer.py
âœ… Metrics Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/visualizer.py
âœ… Insights Generation â”€â”€â”€â”€â”€â”€â†’ agent/sql_agent.py
âœ… Responsive UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/app.py
âœ… Example Queries â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/components.py
âœ… SQL Display â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/components.py
âœ… Data Tables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ui/components.py
âœ… Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ config/settings.py

Total: 16/16 Features âœ…
```

## ğŸš€ Deployment Checklist

```
Pre-deployment:
â”œâ”€ âœ… All dependencies in requirements.txt
â”œâ”€ âœ… .env.example provided
â”œâ”€ âœ… .gitignore configured
â”œâ”€ âœ… Documentation complete
â”œâ”€ âœ… Setup script working
â””â”€ âœ… Error handling robust

Deployment:
â”œâ”€ â–¡ Set environment variables
â”œâ”€ â–¡ Run setup.py
â”œâ”€ â–¡ Test all features
â”œâ”€ â–¡ Monitor logs
â””â”€ â–¡ Configure firewall

Post-deployment:
â”œâ”€ â–¡ Monitor API usage
â”œâ”€ â–¡ Track query performance
â”œâ”€ â–¡ Collect user feedback
â””â”€ â–¡ Plan improvements
```

---

## ğŸ“ Quick Reference

### Start Application
```
streamlit run ui/app.py
```

### Project Statistics
- **Total Files**: 26
- **Python Modules**: 18
- **Lines of Code**: ~2,150
- **Documentation**: 1,200+ lines
- **Features**: 16/16 âœ…

### Tech Stack
```
Frontend:  Streamlit + Plotly
Backend:   Python + SQLite
AI:        LangChain + OpenAI
RAG:       Chroma
```

### Layer Breakdown
```
5 Layers Ã— ~3-4 files each = Clean Architecture
```

---

**Visual Guide Complete!** ğŸ‰

Use this guide to quickly understand the project structure and flow.
